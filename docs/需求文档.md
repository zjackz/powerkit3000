# PowerKit3000 需求说明

## 1. 项目背景
PowerKit3000 面向跨境行业的市场运营团队，围绕 Kickstarter 众筹数据构建一体化分析工具。团队需要在统一数据资产基础上完成导入、筛选、洞察输出与结果分享，以缩短选品决策周期并提升成功率。

## 2. 产品目标
- 打通数据导入 → 存储 → 查询 → 分析 → 展示的闭环，支持分钟级验证市场假设。
- 让运营、分析师与管理层共享统一指标口径，降低人工整理成本。
- 为后续预测模型、协作与商业化能力奠定扩展空间。

## 3. 用户画像与核心场景
- **市场运营/选品经理**：每周筛选高潜项目，输出执行清单与标签。
- **数据分析师**：构建趋势、成功率、竞品对比等报表，为决策提供量化依据。
- **管理层/业务负责人**：快速掌握重点品类、国家表现与资源投入效果。

典型使用场景：
1. 日常项目初筛：按状态、国家、品类、达成率等条件快速过滤项目并导出集合。
2. 品类/国家深度分析：获取多维统计（成功率、总筹资、趋势）以辅助策略制定。
3. 运营复盘：生成周/月报统计，汇报执行成效并识别机会。
4. 数据管理：维护数据导入作业、监控导入失败，并确保数据库一致性。

## 4. 需求范围
| 模块 | 范围 | 说明 |
| --- | --- | --- |
| 数据导入 CLI | `import`/`split`/`counts`/`clear-db` 命令 | 支持 JSON(L) 文件导入、分割、清理及基础统计 |
| 领域服务 (`backend/powerkit3000.core`) | 导入与查询服务 | 统一数据访问逻辑，供 CLI 与 API 复用 |
| 分析 API (`backend/powerkit3000.api`) | 项目列表、筛选器、统计与分析端点 | 提供 REST 接口给前端及外部系统 |
| 前端 (`frontend/tradeforge-suite`) | React 数据探索界面 | 筛选、列表、详情、统计卡片，支持 Mock 回退 |
| 数据层 (`backend/powerkit3000.data`) | EF Core 模型与迁移 | 定义实体关系，维护数据库结构与迁移脚本 |
| Amazon 榜单分析 | Amazon 类目抓取、趋势、报告 | 新增 Amazon 模块：采集快照、趋势分析、报告与前端仪表盘 |
| 文档与运营 | `docs/` 目录 | 需求、规划、技术方案、进度记录，指导跨团队协作 |

不在当前范围：自动 ETL 抓取、机器学习预测、权限体系、商业化付费能力。

## 5. 功能需求
### 5.1 数据导入 CLI
- 支持从单个 JSON/JSONL 文件导入，提供进度反馈与错误日志。
- 运行 `import <path>` 后，去重并写入项目、创作者、类别、地点。（接受重复 ID 则跳过并记录）
- `split <input> --count <n>`：按固定条数或体积拆分大文件，默认输出目录与命名规则。
- `counts`：输出项目、创作者、类别、地点数量总览。
- `clear-db`：清空数据库内所有 Kickstarter 相关表，附带二次确认开关。
- 每个命令提供 `--help`，错误码符合 Unix 约定。

### 5.2 查询与分析服务
- 在 `KickstarterProjectQueryService` 中，实现分页、过滤（状态、国家、品类、目标金额、达成率、上线时间）与模糊搜索。
- 统计指标：总量、成功量、总筹资、总支持者、平均达成率/目标金额、TOP 项目。
- 分析接口：按品类、国家、创作者生成成功率与筹资榜；提供月度趋势、筹资区间分布。
- 所有查询支持 `CancellationToken`，默认按上线时间倒序排序。

### 5.3 分析 API
- `GET /projects`：返回分页项目列表 + 统计信息；参数映射 CLI 查询能力。
- `GET /filters`：输出状态、国家、品类枚举及数量，用于构建筛选器。
- `GET /projects/summary`：返回项目总览指标，可按时间/国家/品类过滤。
- `GET /analytics/categories|countries|creators|top-projects|monthly-trend|funding-distribution`：分别提供多维分析数据。
- `GET /analytics/hype`：结合达成率与筹资速度输出爆款潜力榜，支持 `minPercentFunded`、`limit` 参数。
- `GET /analytics/category-keywords`：基于成功项目生成关键词云，输出词频、覆盖项目数与平均达成率。
- `GET /favorites` / `POST /favorites` / `DELETE /favorites/{projectId}` / `DELETE /favorites`：按客户端标识持久化收藏列表、备注及批量清空能力。
- 所有端点通过 Swagger 暴露，支持 CORS 配置（`Cors:AllowedOrigins`）。
- API 异常返回标准化格式（HTTP 4xx/5xx），并记录日志。

### 5.4 前端界面
- 使用 React + Ant Design + React Query，实现项目列表页：筛选器、表格、分页、详情抽屉。
- 支持趋势统计卡（成功率、达成率、Top 项目、爆款潜力榜、关键词云等），并在 API 失败时回退 Mock 数据。
- 所有请求基于 `VITE_API_BASE_URL` 配置，默认 `http://localhost:5200`。
- 提供基本的加载态、空态与错误提示，统计图/可视化功能按迭代计划逐步上线。

### 5.5 数据与配置
- 数据库使用 Postgres；模型定义于 `backend/powerkit3000.data/Models/*`，迁移由 `dotnet ef` 管理。
- 本地开发可用 SQLite/InMemory 测试，但部署需验证 Postgres 兼容性。
- 可通过环境变量或 User Secrets 覆盖连接字符串；禁止在仓库提交敏感信息。

### 5.6 多语言翻译支持
- 在 `KickstarterProjects` 表新增 `NameCn`、`BlurbCn` 字段，用于存储中文译文。
- CLI 新增 `translate` 命令，批量扫描缺失译文的项目并调用 LLM API 翻译；支持 `--batch-size`、`--max-projects`、`--dry-run` 参数。
- 翻译服务抽象为 `ITranslationProvider`，支持 OpenAI、Gemini、DeepSeek 等可插拔实现，默认 `noop` 返回原文。
- 翻译时需要保留特殊符号/Markdown/HTML，不得破坏占位符。
- API/前端在可用时优先返回中文字段，缺失时回退英文原文。

### 5.7 Amazon 榜单分析模块
- `Amazon` 子域包含类别同步、榜单采集、趋势分析与报告生成：
  - CLI 新增 `amazon-seed`、`amazon-fetch`、`amazon-analyze`、`amazon-report` 命令，基于配置的 Amazon 类目抓取 Top 榜单并输出分析结果。
  - 数据层新增 `AmazonCategories`、`AmazonProducts`、`AmazonSnapshots`、`AmazonProductDataPoints`、`AmazonTrends` 表，记录每日快照与趋势标签。
  - API 提供 `/amazon/*` 端点：创建快照、分析快照、查询核心指标、产品列表、趋势列表、单品历史以及最新报告。
  - 前端新增 “Amazon 榜单” 页面，展示核心指标、榜单表格、趋势卡片与单品历史轨迹。
- 配置项：`Amazon` 节点定义类目列表、抓取延迟、User-Agent 池，可通过环境变量覆盖；后续扩展支持多站点或代理通道。
- 验收：完成最少一组类目抓取→分析→报告→前端展示闭环，接口具备基本空态与错误提示。

## 6. 非功能需求
- **性能**：常规查询 95% 响应时间 < 2s；导入批次可配置批量大小，保证大文件处理稳定。
- **数据质量**：导入成功率 ≥ 99%，出现冲突需有日志并可追踪；字段映射与类型保持与 Kickstarter 原始数据一致。
- **可靠性**：核心命令具备单元测试覆盖；导入失败需打印可定位的错误信息。
- **可维护性**：命令、服务、API 逻辑拆分清晰，复用 Core 层；文档随迭代更新。
- **安全性**：MVP 阶段可依赖网络隔离；未来需支持认证、操作审计与脱敏策略。

## 7. 数据与集成要求
- 样本数据存放于 `backend/powerkit3000.consoleapp/data/`（`sample2.json` 等）。
- CLI 与 API 共用 `AppDbContext`；避免出现不同组件 schema 不一致的情况。
- 前端服务需要 API 开放 CORS；线下可通过 `.env` 指定后端地址。
- 未来若引入外部渠道（如 Slack Webhook），需在此文档登记依赖。

## 8. 验收与度量
- 功能验收以用户故事为单位，运行脚本和 API 调用完成验证。
- 关键指标：项目导入成功率、查询响应时间、项目筛选用时、周报生成时间等。
- 发布前需完成：`dotnet test`、核心命令手动验证（含 `translate`）、前端关键流程冒烟、自检更新文档与变更记录。

## 9. 迭代规划
- **MVP（0-1 月）**：稳定导入流程、基础查询与前端列表、周报指标卡。当前状态：导入/查询/API/基础前端均已上线，监控与协作功能未完备。
- **迭代 1（1-3 月）**：补充可视化分析、收藏/导出、基础告警。当前状态：服务端接口已具备大部分分析能力，前端可视化待开发。
- **迭代 2（3-6 月）**：上线智能推荐、协作模块、权限体系。当前状态：待规划，需依赖数据科学与安全方案。
- **当前新增**：中文翻译闭环已落地；Amazon 榜单模块提供类目同步、快照采集、趋势分析与报告，可与 Kickstarter 数据并行使用；前端展示双语字段与 Amazon 榜单仪表盘。

文档应随需求变更实时更新，并在 PR 或迭代评审时回顾需求与实现差异。
